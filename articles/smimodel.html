<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to smimodel • smimodel</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to smimodel">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">smimodel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/smimodel.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nuwani-palihawadana/smimodel/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to smimodel</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nuwani-palihawadana/smimodel/blob/main/vignettes/smimodel.Rmd" class="external-link"><code>vignettes/smimodel.Rmd</code></a></small>
      <div class="d-none name"><code>smimodel.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="what-is-smimodel">What is smimodel?<a class="anchor" aria-label="anchor" href="#what-is-smimodel"></a>
</h2>
<p>The <em>smimodel</em> package provides functions to estimate
<strong>Sparse Multiple Index (SMI) Models</strong> for nonparametric
forecasting or prediction. To support time series forecasting, the
package functions are mainly build upon tidy temporal data in the
<code>tsibble</code> format. However, the SMI model formulation is very
general and does not exclusively depend on any temporal features. Hence,
the model can be used more widely – even with non-temporal
cross-sectional data. (In such case, a numeric <code>index</code>
(instead of a date or time related variable) can be used when
constructing the <code>tsibble</code>.)</p>
<p>The SMI Modelling algorithm (i.e. the estimation algorithm of SMI
model) that we implement here, simultaneously performs automatic
predictor selection (“sparse”) and predictor grouping, which is
especially useful in obtaining a parsimonious model in high-dimensional
contexts. For detailed information regarding the SMI model and the
estimation algorithm refer the related working paper at <a href="https://www.monash.edu/business/ebs/research/publications/ebs/2024/wp16-2024.pdf" class="external-link uri">https://www.monash.edu/business/ebs/research/publications/ebs/2024/wp16-2024.pdf</a>.</p>
</div>
<div class="section level2">
<h2 id="how-to-use-smimodel">How to use smimodel?<a class="anchor" aria-label="anchor" href="#how-to-use-smimodel"></a>
</h2>
<p>Here we present a simple example to illustrate <em>smimodel</em>
functionalities. We use randomly simualted data, which we treat as time
series data for the purpose of this illustration.</p>
<p>(Note: Since the SMI model estimation algorithm works with very
limited amount of prior information, and handles automatic predictor
selection and predictor grouping, the computational time for model
estimation increases as the number of predictors and the number of
indices increase. Therefore, we use a small simulated data set here as
the example to reduce computational cost.)</p>
<div class="section level3">
<h3 id="data-simulation">Data simulation<a class="anchor" aria-label="anchor" href="#data-simulation"></a>
</h3>
<p>Suppose we are interested in forecasting a response variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>,
which is an additive function of two nonlinear components involving five
predictor variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>_</mi><mn>000</mn><mo>,</mo><mi>x</mi><mi>_</mi><mn>001</mn><mo>,</mo><mi>x</mi><mi>_</mi><mn>002</mn><mo>,</mo><mi>x</mi><mi>_</mi><mn>003</mn></mrow><annotation encoding="application/x-tex">x\_000, x\_001, x\_002, x\_003</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>_</mi><mn>005</mn></mrow><annotation encoding="application/x-tex">x\_005</annotation></semantics></math>
plus a normally distributed white noise component. Here, the variables
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>_</mi><mn>001</mn><mo>,</mo><mi>x</mi><mi>_</mi><mn>002</mn><mo>,</mo><mi>x</mi><mi>_</mi><mn>003</mn></mrow><annotation encoding="application/x-tex">x\_001, x\_002, x\_003</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>_</mi><mn>005</mn></mrow><annotation encoding="application/x-tex">x\_005</annotation></semantics></math>
correspond to the first, second, third and fifth lags of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>_</mi><mn>000</mn></mrow><annotation encoding="application/x-tex">x\_000</annotation></semantics></math>
respectively.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Load required packages </span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nuwani-palihawadana/smimodel" class="external-link">smimodel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://roi.r-forge.r-project.org/" class="external-link">ROI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tsibble.tidyverts.org" class="external-link">tsibble</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Simulate data</span></span>
<span></span>
<span><span class="co"># Length of the time series</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">1405</span> </span>
<span></span>
<span><span class="co"># Set a seed for reproduciblity</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate data</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x_000 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Add x_lags</span></span>
<span>    x <span class="op">=</span> <span class="fu"><a href="../reference/lag_matrix.html">lag_matrix</a></span><span class="op">(</span><span class="va">x_000</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pack.html" class="external-link">unpack</a></span><span class="op">(</span><span class="va">x</span>, names_sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Response variable</span></span>
<span>    y <span class="op">=</span> <span class="op">(</span><span class="fl">0.9</span><span class="op">*</span><span class="va">x_000</span> <span class="op">+</span> <span class="fl">0.6</span><span class="op">*</span><span class="va">x_001</span> <span class="op">+</span> <span class="fl">0.45</span><span class="op">*</span><span class="va">x_003</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span> <span class="op">+</span> </span>
<span>      <span class="op">(</span><span class="fl">0.35</span><span class="op">*</span><span class="va">x_002</span> <span class="op">+</span> <span class="fl">0.7</span><span class="op">*</span><span class="va">x_005</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    <span class="co"># Add an index to the data set</span></span>
<span>    inddd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">inddd</span>, <span class="va">y</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"x_"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Make the data set a `tsibble`</span></span>
<span>  <span class="fu"><a href="https://tsibble.tidyverts.org/reference/as-tsibble.html" class="external-link">as_tsibble</a></span><span class="op">(</span>index <span class="op">=</span> <span class="va">inddd</span><span class="op">)</span></span></code></pre></div>
<p>Note that here we create an additional <code>numeric</code> variable
<code>inddd</code> to serve as the <code>index</code> of the data set,
when we convert the data set into an object of class
<code>tsibble</code>.</p>
<p>Next, we split the data into training and test sets so that the
models can be estimated using the training data set, and the fitted
models can be evaluated on the predictions obtained for the test set,
which is not used for model estimation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Data Split</span></span>
<span></span>
<span><span class="co"># Training set</span></span>
<span><span class="va">sim_train</span> <span class="op">&lt;-</span> <span class="va">sim_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1200</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Test set</span></span>
<span><span class="va">sim_test</span> <span class="op">&lt;-</span> <span class="va">sim_data</span><span class="op">[</span><span class="fl">1201</span><span class="op">:</span><span class="fl">1400</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Here, we sequentially split the data as we assume time series data. </span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="smi-model-estimation">SMI model estimation<a class="anchor" aria-label="anchor" href="#smi-model-estimation"></a>
</h3>
<p>We first train SMI models on the training set using three different
initialisation options “ppr”, “additive” and “linear” for comparison
purposes. Please refer to package documentation/working paper for more
information regarding available initialisation options.</p>
<p>(Note: The choice of the initialisation largely depends on the data
and application. Thus, users are encouraged to follow a trial-and-error
procedure to determine the most suitable initial model for a given
application.)</p>
<p>Here, we assume that we do not have any prior knowledge about the
construction of the response variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>.
Hence, we input
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>_</mi><mn>000</mn></mrow><annotation encoding="application/x-tex">x\_000</annotation></semantics></math>
and its first five lags as our predictor variables into the estimation
algorithm, as predictors which are entering indices.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Index variables</span></span>
<span><span class="va">index.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span></code></pre></div>
<div class="section level4">
<h4 id="smi-model-with-ppr-initialisation">SMI model with “ppr” initialisation:<a class="anchor" aria-label="anchor" href="#smi-model-with-ppr-initialisation"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## SMI model with "PPR" initialisation</span></span>
<span><span class="va">smimodel_ppr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_smimodel.html">model_smimodel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim_train</span>,</span>
<span>                               yvar <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                               index.vars <span class="op">=</span> <span class="va">index.vars</span>,</span>
<span>                               initialise <span class="op">=</span> <span class="st">"ppr"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "model 1"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fitted optimal SMI model</span></span>
<span><span class="va">smimodel_ppr</span><span class="op">$</span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">best</span></span>
<span><span class="co">#&gt; SMI Model Fit:</span></span>
<span><span class="co">#&gt; Index coefficients:</span></span>
<span><span class="co">#&gt; 6 x 2 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;          index1   index2</span></span>
<span><span class="co">#&gt; x_000 1.6277830 .       </span></span>
<span><span class="co">#&gt; x_001 1.0729663 .       </span></span>
<span><span class="co">#&gt; x_002 .         1.213462</span></span>
<span><span class="co">#&gt; x_003 0.8107518 .       </span></span>
<span><span class="co">#&gt; x_004 .         .       </span></span>
<span><span class="co">#&gt; x_005 .         2.296776</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response variable:</span></span>
<span><span class="co">#&gt; [1] "y"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Index variables:</span></span>
<span><span class="co">#&gt; [1] "x_000" "x_001" "x_002" "x_003" "x_004" "x_005"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Spline variables (non-index):</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear variables:</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; GAM Fit:</span></span>
<span><span class="co">#&gt; Family: gaussian </span></span>
<span><span class="co">#&gt; Link function: identity </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; y ~ s(index1, bs = "cr") + s(index2, bs = "cr")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span><span class="co">#&gt; 8.5 6.1  total = 15.6 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; REML score: -1028.843</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimated index structure</span></span>
<span><span class="va">smimodel_ppr</span><span class="op">$</span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">best</span><span class="op">$</span><span class="va">alpha</span></span>
<span><span class="co">#&gt; 6 x 2 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;          index1   index2</span></span>
<span><span class="co">#&gt; x_000 1.6277830 .       </span></span>
<span><span class="co">#&gt; x_001 1.0729663 .       </span></span>
<span><span class="co">#&gt; x_002 .         1.213462</span></span>
<span><span class="co">#&gt; x_003 0.8107518 .       </span></span>
<span><span class="co">#&gt; x_004 .         .       </span></span>
<span><span class="co">#&gt; x_005 .         2.296776</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="smi-model-with-additive-initialisation">SMI model with “additive” initialisation:<a class="anchor" aria-label="anchor" href="#smi-model-with-additive-initialisation"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## SMI model with "Additive" initialisation</span></span>
<span><span class="va">smimodel_additive</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_smimodel.html">model_smimodel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim_train</span>,</span>
<span>                                    yvar <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                                    index.vars <span class="op">=</span> <span class="va">index.vars</span>,</span>
<span>                                    initialise <span class="op">=</span> <span class="st">"additive"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "model 1"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fitted optimal SMI model</span></span>
<span><span class="va">smimodel_additive</span><span class="op">$</span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">best</span></span>
<span><span class="co">#&gt; SMI Model Fit:</span></span>
<span><span class="co">#&gt; Index coefficients:</span></span>
<span><span class="co">#&gt; 6 x 2 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;          index1   index2</span></span>
<span><span class="co">#&gt; x_000 0.4634888 .       </span></span>
<span><span class="co">#&gt; x_001 0.3055250 .       </span></span>
<span><span class="co">#&gt; x_002 .         0.345865</span></span>
<span><span class="co">#&gt; x_003 0.2309862 .       </span></span>
<span><span class="co">#&gt; x_004 .         .       </span></span>
<span><span class="co">#&gt; x_005 .         0.654135</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response variable:</span></span>
<span><span class="co">#&gt; [1] "y"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Index variables:</span></span>
<span><span class="co">#&gt; [1] "x_000" "x_001" "x_002" "x_003" "x_004" "x_005"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Spline variables (non-index):</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear variables:</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; GAM Fit:</span></span>
<span><span class="co">#&gt; Family: gaussian </span></span>
<span><span class="co">#&gt; Link function: identity </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; y ~ s(index1, bs = "cr") + s(index2, bs = "cr")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span><span class="co">#&gt; 8.5 6.1  total = 15.6 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; REML score: -1028.838</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimated index structure</span></span>
<span><span class="va">smimodel_additive</span><span class="op">$</span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">best</span><span class="op">$</span><span class="va">alpha</span></span>
<span><span class="co">#&gt; 6 x 2 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;          index1   index2</span></span>
<span><span class="co">#&gt; x_000 0.4634888 .       </span></span>
<span><span class="co">#&gt; x_001 0.3055250 .       </span></span>
<span><span class="co">#&gt; x_002 .         0.345865</span></span>
<span><span class="co">#&gt; x_003 0.2309862 .       </span></span>
<span><span class="co">#&gt; x_004 .         .       </span></span>
<span><span class="co">#&gt; x_005 .         0.654135</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="smi-model-with-linear-initialisation">SMI model with “linear” initialisation:<a class="anchor" aria-label="anchor" href="#smi-model-with-linear-initialisation"></a>
</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## SMI model with "Linear" initialisation</span></span>
<span><span class="va">smimodel_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/model_smimodel.html">model_smimodel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim_train</span>,</span>
<span>                                  yvar <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                                  index.vars <span class="op">=</span> <span class="va">index.vars</span>,</span>
<span>                                  initialise <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "model 1"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fitted optimal SMI model</span></span>
<span><span class="va">smimodel_linear</span><span class="op">$</span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">best</span></span>
<span><span class="co">#&gt; SMI Model Fit:</span></span>
<span><span class="co">#&gt; Index coefficients:</span></span>
<span><span class="co">#&gt; 6 x 2 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;          index1    index2</span></span>
<span><span class="co">#&gt; x_000 0.4636130 .        </span></span>
<span><span class="co">#&gt; x_001 0.3055494 .        </span></span>
<span><span class="co">#&gt; x_002 .         0.3467785</span></span>
<span><span class="co">#&gt; x_003 0.2308376 .        </span></span>
<span><span class="co">#&gt; x_004 .         .        </span></span>
<span><span class="co">#&gt; x_005 .         0.6532215</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response variable:</span></span>
<span><span class="co">#&gt; [1] "y"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Index variables:</span></span>
<span><span class="co">#&gt; [1] "x_000" "x_001" "x_002" "x_003" "x_004" "x_005"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Spline variables (non-index):</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear variables:</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; GAM Fit:</span></span>
<span><span class="co">#&gt; Family: gaussian </span></span>
<span><span class="co">#&gt; Link function: identity </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; y ~ s(index1, bs = "cr") + s(index2, bs = "cr")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span><span class="co">#&gt; 8.50 6.12  total = 15.62 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; REML score: -1028.798</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimated index structure</span></span>
<span><span class="va">smimodel_linear</span><span class="op">$</span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">best</span><span class="op">$</span><span class="va">alpha</span></span>
<span><span class="co">#&gt; 6 x 2 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;          index1    index2</span></span>
<span><span class="co">#&gt; x_000 0.4636130 .        </span></span>
<span><span class="co">#&gt; x_001 0.3055494 .        </span></span>
<span><span class="co">#&gt; x_002 .         0.3467785</span></span>
<span><span class="co">#&gt; x_003 0.2308376 .        </span></span>
<span><span class="co">#&gt; x_004 .         .        </span></span>
<span><span class="co">#&gt; x_005 .         0.6532215</span></span></code></pre></div>
<p>In this case, all three SMI models fitted (with “ppr”, “additive” and
“linear” initialisation options) have correctly identified the index
structure of the response
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
by estimating two linear combinations (i.e. indices), while dropping out
the irrelevant predictor
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mi>_</mi><mn>004</mn></mrow><annotation encoding="application/x-tex">x\_004</annotation></semantics></math>.</p>
<p>(Note: The final estimated model may change depending on the
initialisation option chosen. Hence, the users are encouraged to
experiment with different available initialisation options when choosing
the best fit for the data/application of interest. In a real-world
problem (where the true model is unknown), it will be useful to fit SMI
models with different initialisation options, and see which option gives
the best forecasting/prediction accuracy.)</p>
</div>
</div>
<div class="section level3">
<h3 id="visualisation-of-estimated-smooths">Visualisation of estimated smooths<a class="anchor" aria-label="anchor" href="#visualisation-of-estimated-smooths"></a>
</h3>
<p>Once you fit a SMI model, the partial effects of the estimated
smooths corresponding to the estimated indices can be plotted using the
<code>autoplot</code> method as below.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot estimated smooths of the SMI model with "ppr" initialisation</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">smimodel_ppr</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/autoplot-1.png" alt="plot of chunk autoplot"><div class="figcaption">plot of chunk autoplot</div>
</div>
</div>
<div class="section level3">
<h3 id="residuals-and-fitted-values">Residuals and fitted values<a class="anchor" aria-label="anchor" href="#residuals-and-fitted-values"></a>
</h3>
<p>We can use the <code>augment</code> method to obtain the residuals
and the fitted values from an estimated SMI model.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Obtain residuals and fitted values</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">smimodel_ppr</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1,200 × 3</span></span>
<span><span class="co">#&gt;    Index   .resid .fitted</span></span>
<span><span class="co">#&gt;    &lt;int&gt;    &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1     6  0.0560    0.758</span></span>
<span><span class="co">#&gt;  2     7 -0.0398    1.50 </span></span>
<span><span class="co">#&gt;  3     8 -0.0549    3.78 </span></span>
<span><span class="co">#&gt;  4     9  0.0500    1.78 </span></span>
<span><span class="co">#&gt;  5    10  0.155     1.88 </span></span>
<span><span class="co">#&gt;  6    11 -0.145     3.70 </span></span>
<span><span class="co">#&gt;  7    12  0.200     2.16 </span></span>
<span><span class="co">#&gt;  8    13 -0.00581   2.20 </span></span>
<span><span class="co">#&gt;  9    14 -0.0587    2.78 </span></span>
<span><span class="co">#&gt; 10    15  0.0687    0.588</span></span>
<span><span class="co">#&gt; # ℹ 1,190 more rows</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="forecasts-on-a-test-set">Forecasts on a test set<a class="anchor" aria-label="anchor" href="#forecasts-on-a-test-set"></a>
</h3>
<p>Based on an estimated SMI model, we obtain forecasts/predictions on a
test set as below, using the <code>predict</code> method.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Obtain forecasts on the test set</span></span>
<span><span class="va">preds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">smimodel_ppr</span>, newdata <span class="op">=</span> <span class="va">sim_test</span><span class="op">)</span></span>
<span><span class="va">preds</span><span class="op">$</span><span class="va">.predict</span></span>
<span><span class="co">#&gt;          1          2          3          4          5          6          7          8 </span></span>
<span><span class="co">#&gt; 3.45843482 1.52233929 0.52915671 2.23979539 1.12095152 1.37701048 3.45916664 1.29311926 </span></span>
<span><span class="co">#&gt;          9         10         11         12         13         14         15         16 </span></span>
<span><span class="co">#&gt; 1.30501441 0.76679807 0.94005154 1.69171847 1.19072414 1.31337854 1.62219972 2.32412054 </span></span>
<span><span class="co">#&gt;         17         18         19         20         21         22         23         24 </span></span>
<span><span class="co">#&gt; 0.83485639 1.04503698 1.18641786 4.77792576 0.61146893 1.14608392 0.79743662 1.40762829 </span></span>
<span><span class="co">#&gt;         25         26         27         28         29         30         31         32 </span></span>
<span><span class="co">#&gt; 2.33510632 0.17597884 0.55499981 0.36522200 0.86654016 0.58190432 0.07687419 0.12706185 </span></span>
<span><span class="co">#&gt;         33         34         35         36         37         38         39         40 </span></span>
<span><span class="co">#&gt; 0.59343493 2.34185400 0.88253877 0.31336997 0.47271658 0.98664796 1.08475055 1.63218384 </span></span>
<span><span class="co">#&gt;         41         42         43         44         45         46         47         48 </span></span>
<span><span class="co">#&gt; 1.08462208 0.94685717 0.69773155 0.29353883 1.42673101 1.80559706 1.56668680 1.60935120 </span></span>
<span><span class="co">#&gt;         49         50         51         52         53         54         55         56 </span></span>
<span><span class="co">#&gt; 0.47009455 0.52983748 1.75310041 0.35657771 0.52346543 2.84389939 1.52548116 1.21179344 </span></span>
<span><span class="co">#&gt;         57         58         59         60         61         62         63         64 </span></span>
<span><span class="co">#&gt; 1.57460678 0.35170993 0.81595949 1.16945351 0.14737637 0.76259052 3.59274308 0.41202691 </span></span>
<span><span class="co">#&gt;         65         66         67         68         69         70         71         72 </span></span>
<span><span class="co">#&gt; 2.45045046 1.07377542 0.95611899 2.54999411 0.60652246 3.72765379 1.90551702 2.62672272 </span></span>
<span><span class="co">#&gt;         73         74         75         76         77         78         79         80 </span></span>
<span><span class="co">#&gt; 2.97464279 1.17286068 1.32248353 0.58831081 1.53233149 2.14607215 1.74226840 2.66106411 </span></span>
<span><span class="co">#&gt;         81         82         83         84         85         86         87         88 </span></span>
<span><span class="co">#&gt; 0.79446176 2.20873718 1.95711933 1.04782140 1.37583209 2.27205189 1.86749216 0.84887843 </span></span>
<span><span class="co">#&gt;         89         90         91         92         93         94         95         96 </span></span>
<span><span class="co">#&gt; 2.17380289 1.42472135 0.92674929 2.26138084 2.21902797 3.09125236 2.79493313 0.60640910 </span></span>
<span><span class="co">#&gt;         97         98         99        100        101        102        103        104 </span></span>
<span><span class="co">#&gt; 1.10386530 1.38544895 1.84807628 2.95947510 1.75696400 0.83750488 0.44672968 1.24063710 </span></span>
<span><span class="co">#&gt;        105        106        107        108        109        110        111        112 </span></span>
<span><span class="co">#&gt; 0.44698763 0.43814184 0.43480837 1.11387344 0.90802148 0.98412301 0.77399901 0.92781919 </span></span>
<span><span class="co">#&gt;        113        114        115        116        117        118        119        120 </span></span>
<span><span class="co">#&gt; 1.44309503 0.53601097 0.70986280 0.71780586 1.41745632 1.35757618 2.13593015 2.08429787 </span></span>
<span><span class="co">#&gt;        121        122        123        124        125        126        127        128 </span></span>
<span><span class="co">#&gt; 2.88104888 0.93104399 2.19651802 0.26130171 1.22262725 1.28590866 0.54812550 1.30396156 </span></span>
<span><span class="co">#&gt;        129        130        131        132        133        134        135        136 </span></span>
<span><span class="co">#&gt; 1.46480333 1.18319405 0.66373798 1.22840273 2.41410935 2.60613213 2.59292461 0.97764028 </span></span>
<span><span class="co">#&gt;        137        138        139        140        141        142        143        144 </span></span>
<span><span class="co">#&gt; 1.39710638 1.03590256 0.73885115 1.11010945 2.98224561 1.16424945 1.56661578 2.29979223 </span></span>
<span><span class="co">#&gt;        145        146        147        148        149        150        151        152 </span></span>
<span><span class="co">#&gt; 1.45017582 1.01202295 0.19616637 0.24760981 0.17676178 0.24514812 0.11934916 0.06336549 </span></span>
<span><span class="co">#&gt;        153        154        155        156        157        158        159        160 </span></span>
<span><span class="co">#&gt; 0.78679674 0.77522978 0.44446630 2.11473265 0.36401620 1.84107675 1.72220377 0.56277107 </span></span>
<span><span class="co">#&gt;        161        162        163        164        165        166        167        168 </span></span>
<span><span class="co">#&gt; 0.86527742 0.15397755 0.86058688 0.36201708 0.16952403 0.38383432 0.08906202 0.44081266 </span></span>
<span><span class="co">#&gt;        169        170        171        172        173        174        175        176 </span></span>
<span><span class="co">#&gt; 0.88282070 1.29237794 2.58721676 1.48405203 3.04060340 1.20293468 1.04606752 2.14209043 </span></span>
<span><span class="co">#&gt;        177        178        179        180        181        182        183        184 </span></span>
<span><span class="co">#&gt; 0.44201454 2.79361783 0.52732444 1.55414248 1.42598659 0.36663459 2.72500268 0.29617963 </span></span>
<span><span class="co">#&gt;        185        186        187        188        189        190        191        192 </span></span>
<span><span class="co">#&gt; 0.87044077 2.92102132 1.94128710 1.64401566 1.23797710 0.96011158 2.37027743 2.37107628 </span></span>
<span><span class="co">#&gt;        193        194        195        196        197        198        199        200 </span></span>
<span><span class="co">#&gt; 1.44414361 0.58086686 0.37871181 0.50380451 0.34436357 0.18857385 0.20219476 0.26610323</span></span></code></pre></div>
<p>Once we obtain forecasts/predictions, we can evaluate the
forecasting/predictive performance of the estimated SMI model by
calculating forecast/prediction error measurements as desired.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Calculate test set MSE and MAE</span></span>
<span><span class="va">MSE_SMI_ppr</span> <span class="op">=</span> <span class="fu"><a href="../reference/point_measures.html">MSE</a></span><span class="op">(</span>residuals <span class="op">=</span> <span class="op">(</span><span class="va">preds</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="va">preds</span><span class="op">$</span><span class="va">.predict</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MSE_SMI_ppr</span></span>
<span><span class="co">#&gt; [1] 0.01267114</span></span>
<span><span class="va">MAE_SMI_ppr</span> <span class="op">=</span> <span class="fu"><a href="../reference/point_measures.html">MAE</a></span><span class="op">(</span>residuals <span class="op">=</span> <span class="op">(</span><span class="va">preds</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="va">preds</span><span class="op">$</span><span class="va">.predict</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">MAE_SMI_ppr</span></span>
<span><span class="co">#&gt; [1] 0.08956175</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tuning-for-penalty-parameters">Tuning for penalty parameters<a class="anchor" aria-label="anchor" href="#tuning-for-penalty-parameters"></a>
</h3>
<p>The estimation of a SMI model involves solving an optimaisation
problem, where the sum of squared errors of the model plus two penalty
terms (an L0 penalty and an L2 (ridge) penalty) is minimised subject to
a set of constraints (please refer the working paper for details). Thus,
two penalty parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\lambda_{0}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\lambda_{2}</annotation></semantics></math>
corresponding to the L0 and L2 penalties respectively should be chosen
when estimating a SMI model.</p>
<p>In the previous example, all the SMI models were fitted using the
default penalty parameter values provided in the function:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_{0} = 1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>λ</mi><mn>2</mn></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda_{2} = 1</annotation></semantics></math>.
To fit a SMI model with simultaneous parameter tuning, we can use the
function <code><a href="../reference/greedy_smimodel.html">greedy_smimodel()</a></code>, which performs a greedy search
over a given grid of penalty parameter combinations
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\lambda_{0}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mn>2</mn></msub><annotation encoding="application/x-tex">\lambda_{2}</annotation></semantics></math>),
and fits the SMI model using the best (lowest validation set MSE)
penalty parameter combination. In this case, we need to provide a
validation set, which is separate from the training data set.</p>
<p>Therefore, let’s split our original training set in the above example
into two parts again to obtain a validation set.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># New training set</span></span>
<span><span class="va">sim_train_new</span> <span class="op">&lt;-</span> <span class="va">sim_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Validation set</span></span>
<span><span class="va">sim_val_new</span> <span class="op">&lt;-</span> <span class="va">sim_data</span><span class="op">[</span><span class="fl">1001</span><span class="op">:</span><span class="fl">1200</span>, <span class="op">]</span></span></code></pre></div>
<p>Next, we can estimate the SMI model with simultaneous penalty
parameter tuning as follows. Here, we use the initialisation option
“ppr” just to demonstrate the functionality.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Estimating SMI model with penalty parameter tuning</span></span>
<span><span class="va">smimodel_ppr_tune</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/greedy_smimodel.html">greedy_smimodel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim_train_new</span>, </span>
<span>                                     val.data <span class="op">=</span> <span class="va">sim_val_new</span>,</span>
<span>                                     yvar <span class="op">=</span> <span class="st">"y"</span>,</span>
<span>                                     index.vars <span class="op">=</span> <span class="va">index.vars</span>,</span>
<span>                                     initialise <span class="op">=</span> <span class="st">"ppr"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "model 1"</span></span>
<span><span class="co">#&gt; [1] "model 1"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Potential starting points completed."</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Initial search around potential starting point 1 completed."</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Initial search around potential starting point 2 completed."</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Initial search around potential starting point 3 completed."</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Maximum iterations reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Initial search around potential starting point 4 completed."</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Initial search around potential starting point 5 completed."</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Initial search around potential starting point 6 completed."</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Initial search around potential starting point 7 completed."</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Initial search around potential starting point 8 completed."</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Tolerance for loss reached!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Initial search around potential starting point 9 completed."</span></span>
<span><span class="co">#&gt; [1] "Starting point for the greedy search selected."</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Loss increased for 3 consecutive iterations!"</span></span>
<span><span class="co">#&gt; [1] "Final model fitted!"</span></span>
<span><span class="co">#&gt; [1] "Final SMI model is fitted."</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fitted optimal SMI model</span></span>
<span><span class="va">smimodel_ppr_tune</span><span class="op">$</span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">best</span></span>
<span><span class="co">#&gt; SMI Model Fit:</span></span>
<span><span class="co">#&gt; Index coefficients:</span></span>
<span><span class="co">#&gt; 6 x 2 sparse Matrix of class "dgCMatrix"</span></span>
<span><span class="co">#&gt;          index1   index2</span></span>
<span><span class="co">#&gt; x_000 1.6275097 .       </span></span>
<span><span class="co">#&gt; x_001 1.0728695 .       </span></span>
<span><span class="co">#&gt; x_002 .         1.214242</span></span>
<span><span class="co">#&gt; x_003 0.8111214 .       </span></span>
<span><span class="co">#&gt; x_004 .         .       </span></span>
<span><span class="co">#&gt; x_005 .         2.295995</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response variable:</span></span>
<span><span class="co">#&gt; [1] "y"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Index variables:</span></span>
<span><span class="co">#&gt; [1] "x_000" "x_001" "x_002" "x_003" "x_004" "x_005"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Spline variables (non-index):</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Linear variables:</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; GAM Fit:</span></span>
<span><span class="co">#&gt; Family: gaussian </span></span>
<span><span class="co">#&gt; Link function: identity </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Formula:</span></span>
<span><span class="co">#&gt; y ~ s(index1, bs = "cr") + s(index2, bs = "cr")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated degrees of freedom:</span></span>
<span><span class="co">#&gt; 8.5 6.1  total = 15.6 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; REML score: -1028.836</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Selected penalty parameter combination</span></span>
<span><span class="va">smimodel_ppr_tune</span><span class="op">$</span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">best_lambdas</span></span>
<span><span class="co">#&gt; [1] 1.180046 1.000000</span></span></code></pre></div>
<p>Here the selected penalty parameter combination is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>λ</mi><mn>0</mn></msub><mo>,</mo><msub><mi>λ</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1.180046</mn><mo>,</mo><mn>1.000000</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(\lambda_{0}, \lambda_{2}) = (1.180046, 1.000000)</annotation></semantics></math>.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nuwani Palihawadana.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
