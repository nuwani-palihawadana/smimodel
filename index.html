<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Sparse Multiple Index (SMI) Models for Nonparametric Forecasting and Prediction • smimodel</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Sparse Multiple Index (SMI) Models for Nonparametric Forecasting and Prediction">
<meta name="description" content="Implements a general algorithm for estimating Sparse Multiple Index (SMI) models for nonparametric forecasting and prediction. Includes functions for fitting nonparametric additive models with backward elimination, group-wise additive index models, and projection pursuit regression models as benchmark comparison methods. Provides tools for generating prediction intervals to quantify uncertainty in point forecasts produced by the SMI model and benchmark models, using either the classical Block Bootstrap method or a novel Conformal Bootstrap approach that integrates block bootstrap with split conformal prediction through an online updating procedure.">
<meta property="og:description" content="Implements a general algorithm for estimating Sparse Multiple Index (SMI) models for nonparametric forecasting and prediction. Includes functions for fitting nonparametric additive models with backward elimination, group-wise additive index models, and projection pursuit regression models as benchmark comparison methods. Provides tools for generating prediction intervals to quantify uncertainty in point forecasts produced by the SMI model and benchmark models, using either the classical Block Bootstrap method or a novel Conformal Bootstrap approach that integrates block bootstrap with split conformal prediction through an online updating procedure.">
<meta property="og:image" content="https://nuwani-palihawadana.github.io/smimodel/logo.png">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">smimodel</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/smimodel.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nuwani-palihawadana/smimodel/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="smimodel-">smimodel <a class="anchor" aria-label="anchor" href="#smimodel-"></a>
</h1>
</div>
<!-- badges: start -->
<!-- badges: end -->
<p>The R package <em>smimodel</em> provides functions to estimate Sparse Multiple Index (SMI) Models for nonparametric forecasting/prediction. The SMI Modelling algorithm simultaneously performs optimal predictor selection (hence “sparse”) and predictor grouping, enabling parsimonious forecasting/prediction models in a high-dimensional context.</p>
<p>The package also includes functions to fit some benchmark comparison methods namely nonparametric additive model with backward elimination, group-wise additive index model and projection pursuit regression. These functions are designed to have a similar syntax and output format for convenient usage and interchangeability.</p>
<div class="section level4">
<h4 id="additional-functionalities">Additional Functionalities:<a class="anchor" aria-label="anchor" href="#additional-functionalities"></a>
</h4>
<p>Furthermore, the smimodel package provides functions to generate prediction intervals to estimate uncertainty of the point forecasts produced by the SMI model and given benchmark models in time series forecasting problems. The classical <em>Block Bootstrap</em> method and a novel method named <em>Conformal Bootstrap</em>, which is a natural integration of block bootstrap and classical split conformal prediction, are implemented as prediction interval generation methods through a general online updating procedure as introduced by Wang and Hyndman (2024) (<a href="https://arxiv.org/pdf/2410.13115" class="external-link uri">https://arxiv.org/pdf/2410.13115</a>).</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the the development version of smimodel from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"nuwani-palihawadana/smimodel"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="other-required-software">Other Required Software<a class="anchor" aria-label="anchor" href="#other-required-software"></a>
</h2>
<div class="section level3">
<h3 id="gurobi-solver">Gurobi Solver<a class="anchor" aria-label="anchor" href="#gurobi-solver"></a>
</h3>
<p>The estimation of SMI model is based on an iterative procedure that is developed using Mixed Integer Programming (MIP) to solve an L0 and L2-regularised nonlinear least squares optimisation problem with linear constraints. We use the commercial MIP solver <a href="https://www.gurobi.com/" class="external-link"><em>Gurobi</em></a> to solve the mixed integer programs, as it is the fastest and the most powerful MIP solver currently available. Hence, the users of <em>smimodel</em> are required to have an active installation of Gurobi in their local machines.</p>
<div class="section level4">
<h4 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h4>
<p>Since Gurobi is a commercial software, the users need to obtain a <a href="https://support.gurobi.com/hc/en-us/articles/12684663118993-How-do-I-obtain-a-Gurobi-license" class="external-link">license for Gurobi</a> before they can install/use it.</p>
<p>Gurobi provides free license for academics affiliated with recognised educational institutions. Hence, if you are an academic, you can register for a free account with your verified institutional email, and then request a <a href="https://www.gurobi.com/academia/academic-program-and-licenses/" class="external-link">free academic license</a>. If you are not affiliated with a recognised educational institution, you might need to purchase a license for long term use. However, you can obtain a <a href="https://www.gurobi.com/downloads/request-an-evaluation-license/" class="external-link">free 30-day trial by requesting for an evaluation license</a>.</p>
</div>
<div class="section level4">
<h4 id="installation-1">Installation<a class="anchor" aria-label="anchor" href="#installation-1"></a>
</h4>
<p>Fortunately, Gurobi provides <a href="https://docs.gurobi.com/current/" class="external-link">comprehensive documentation</a> regarding installation as well as usage, and provides active support at the <a href="https://support.gurobi.com/hc/en-us" class="external-link">Gurobi Help Center</a>.</p>
<p>For step-by-step instructions on software installation and license activation process, go to <a href="https://support.gurobi.com/hc/en-us/articles/14799677517585-Getting-Started-with-Gurobi-Optimizer" class="external-link">this link</a>. Note that the procedure for installing Gurobi depends on the operating system that you are using in your local machine. The platform-specific instructions can be found <a href="https://support.gurobi.com/hc/en-us/articles/4534161999889-How-do-I-install-Gurobi-Optimizer" class="external-link">here</a>.</p>
</div>
</div>
<div class="section level3">
<h3 id="r-package-gurobi">R Package “gurobi”<a class="anchor" aria-label="anchor" href="#r-package-gurobi"></a>
</h3>
<p>Once Gurobi solver is installed in your local machine, next you need to install the Gurobi R interface through “gurobi” R package, to use gurobi within R. This package is not available on CRAN, and is exclusively distributed with the Gurobi software suite. The instructions on how to install the gurobi R package are provided <a href="https://support.gurobi.com/hc/en-us/articles/14462206790033-How-do-I-install-Gurobi-for-R" class="external-link">here</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a basic example, which shows you how to estimate a SMI model, and obtain predictions on a test set:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nuwani-palihawadana/smimodel" class="external-link">smimodel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://roi.r-forge.r-project.org/" class="external-link">ROI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tsibble.tidyverts.org" class="external-link">tsibble</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate data</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">1205</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>x_lag_000 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Add x_lags</span></span>
<span>    x_lag <span class="op">=</span> <span class="fu"><a href="reference/lag_matrix.html">lag_matrix</a></span><span class="op">(</span><span class="va">x_lag_000</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pack.html" class="external-link">unpack</a></span><span class="op">(</span><span class="va">x_lag</span>, names_sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    <span class="co"># Response variable</span></span>
<span>    y1 <span class="op">=</span> <span class="op">(</span><span class="fl">0.9</span><span class="op">*</span><span class="va">x_lag_000</span> <span class="op">+</span> <span class="fl">0.6</span><span class="op">*</span><span class="va">x_lag_001</span> <span class="op">+</span> <span class="fl">0.45</span><span class="op">*</span><span class="va">x_lag_003</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>    <span class="co"># Add an index to the data set</span></span>
<span>    inddd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">inddd</span>, <span class="va">y1</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"x_lag"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># Make the data set a `tsibble`</span></span>
<span>  <span class="fu"><a href="https://tsibble.tidyverts.org/reference/as-tsibble.html" class="external-link">as_tsibble</a></span><span class="op">(</span>index <span class="op">=</span> <span class="va">inddd</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Training set</span></span>
<span><span class="va">sim_train</span> <span class="op">&lt;-</span> <span class="va">sim_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">]</span></span>
<span><span class="co"># Test set</span></span>
<span><span class="va">sim_test</span> <span class="op">&lt;-</span> <span class="va">sim_data</span><span class="op">[</span><span class="fl">1001</span><span class="op">:</span><span class="fl">1200</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Index variables</span></span>
<span><span class="va">index.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate SMI model (with "PPR" initialisation)</span></span>
<span><span class="va">smimodel_ppr</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/model_smimodel.html">model_smimodel</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">sim_train</span>,</span>
<span>                               yvar <span class="op">=</span> <span class="st">"y1"</span>,</span>
<span>                               index.vars <span class="op">=</span> <span class="va">index.vars</span>,</span>
<span>                               initialise <span class="op">=</span> <span class="st">"ppr"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fitted SMI model</span></span>
<span><span class="va">smimodel_ppr</span><span class="op">$</span><span class="va">fit</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">best</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot estimated smooths</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">smimodel_ppr</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="100%"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Obtain residuals and fitted values</span></span>
<span><span class="fu"><a href="https://generics.r-lib.org/reference/augment.html" class="external-link">augment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">smimodel_ppr</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1,000 × 3</span></span>
<span><span class="co">#&gt;    Index  .resid .fitted</span></span>
<span><span class="co">#&gt;    &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1     6  0.0859   0.495</span></span>
<span><span class="co">#&gt;  2     7  0.0766   0.737</span></span>
<span><span class="co">#&gt;  3     8  0.137    3.70 </span></span>
<span><span class="co">#&gt;  4     9  0.0173   1.15 </span></span>
<span><span class="co">#&gt;  5    10  0.118    0.942</span></span>
<span><span class="co">#&gt;  6    11 -0.201    3.65 </span></span>
<span><span class="co">#&gt;  7    12 -0.0471   1.83 </span></span>
<span><span class="co">#&gt;  8    13  0.0111   1.28 </span></span>
<span><span class="co">#&gt;  9    14 -0.0464   2.46 </span></span>
<span><span class="co">#&gt; 10    15  0.0243   0.261</span></span>
<span><span class="co">#&gt; # ℹ 990 more rows</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Obtain predictions on the test set</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">smimodel_ppr</span>, newdata <span class="op">=</span> <span class="va">sim_test</span><span class="op">)</span><span class="op">$</span><span class="va">.predict</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="license-1">License<a class="anchor" aria-label="anchor" href="#license-1"></a>
</h2>
<p>This package is free and open-source software, licensed under GPL-3.</p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/nuwani-palihawadana/smimodel/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/nuwani-palihawadana/smimodel/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing smimodel</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Nuwani Palihawadana <br><small class="roles"> Author, maintainer, copyright holder </small> <a href="https://orcid.org/0009-0008-6395-7797" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nuwani Palihawadana.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
